<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Flow</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;height:100%}
body{
Â  background:#000;
Â  overflow:hidden;
Â  font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
}

#bgCanvas{position:fixed;inset:0;z-index:1}

.overlay{
Â  position:fixed;inset:0;
Â  background:radial-gradient(circle,rgba(0,0,0,.5),rgba(0,0,0,.85));
Â  z-index:5;
}

.popup{
Â  position:fixed;
Â  left:50%;top:50%;
Â  transform:translate(-50%,-50%) scale(.6);
Â  width:90%;max-width:520px;
Â  padding:42px 38px;
Â  background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(18,18,18,.92));
Â  border-radius:22px;
Â  border:1px solid rgba(255,215,0,.25);
Â  backdrop-filter:blur(18px);
Â  box-shadow:0 40px 120px rgba(0,0,0,.95);
Â  z-index:10;
Â  opacity:0;
Â  transition:.7s cubic-bezier(.16,1,.3,1);
}
.popup.show{opacity:1;transform:translate(-50%,-50%) scale(1)}
.popup.exit{
Â  transform:translate(-50%,120%) scale(.9);
Â  opacity:0;
Â  transition:.35s cubic-bezier(.7,0,.9,.3);
}

.badge{
Â  display:inline-block;
Â  padding:6px 14px;
Â  border-radius:999px;
Â  font-size:.75rem;
Â  font-weight:600;
Â  color:#000;
Â  background:linear-gradient(135deg,#FFD700,#FFA500);
Â  margin-bottom:16px;
}
.popup h2{font-size:1.9rem;color:#FFD700;margin-bottom:8px}
.popup p{color:#cfcfcf;font-size:.95rem;margin-bottom:18px}
.reaction{
Â  font-size:.9rem;
Â  color:#FFD700;
Â  margin-bottom:24px;
Â  min-height:20px;
Â  text-align:left;
}

.popup input[type=number]{
Â  width:100%;
Â  padding:16px;
Â  font-size:1.2rem;
Â  border-radius:14px;
Â  border:1px solid rgba(255,215,0,.35);
Â  background:rgba(0,0,0,.4);
Â  color:#FFD700;
Â  text-align:center;
Â  outline:none;
Â  margin-bottom:30px;
Â  appearance:textfield;
}
.popup input::-webkit-inner-spin-button,
.popup input::-webkit-outer-spin-button{
Â  -webkit-appearance:none;
Â  margin:0;
}

.warning-message{
Â  font-size:0.85rem;
Â  color:#FF6B6B;
Â  padding:8px 12px;
Â  background:rgba(255,107,107,.15);
Â  border-left:3px solid #FF6B6B;
Â  border-radius:4px;
Â  text-align:left;
Â  margin-bottom:20px;
Â  display:none;
}

.warning-message.show{
Â  display:block;
}

.actions button{
Â  width:100%;
Â  padding:16px;
Â  border-radius:14px;
Â  font-weight:700;
Â  cursor:pointer;
Â  border:none;
Â  font-size:1rem;
Â  background:linear-gradient(135deg,#FFD700,#FFA500);
Â  color:#000;
}

.actions button:disabled{
Â  opacity:0.5;
Â  cursor:not-allowed;
}

.categories{
Â  display:grid;
Â  grid-template-columns:repeat(2,1fr);
Â  gap:14px;
Â  margin-top:24px;
}
.cat{
Â  padding:14px;
Â  border-radius:12px;
Â  text-align:center;
Â  font-weight:600;
Â  background:rgba(255,255,255,.06);
Â  border:1px solid rgba(255,215,0,.25);
Â  color:#FFD700;
Â  cursor:pointer;
Â  transition:.2s;
}
.cat:hover{background:rgba(255,215,0,.15)}
.cat.selected{background:rgba(255,215,0,.35);color:#000}

.exp-value{
Â  font-size:1.2rem;
Â  color:#FFD700;
Â  text-align:center;
Â  margin-bottom:18px;
}
.exp-slider{width:100%;margin-bottom:30px}

.ai-assistant{
Â  position:fixed;
Â  right:26px;
Â  bottom:26px;
Â  z-index:50;
Â  display:flex;
Â  align-items:flex-end;
Â  gap:10px;
Â  pointer-events:none;
Â  opacity:1;
Â  transition:opacity 0.3s;
}

.ai-assistant.hidden{
Â  opacity:0;
Â  pointer-events:none;
}

.ai-robot{
Â  font-size:42px;
Â  animation:float 3s ease-in-out infinite;
}
@keyframes float{
Â  0%,100%{transform:translateY(0)}
Â  50%{transform:translateY(-6px)}
}
.ai-bubble{
Â  background:rgba(18,18,18,.9);
Â  border:1px solid rgba(255,215,0,.35);
Â  border-radius:14px;
Â  padding:12px 16px;
Â  display:flex;
Â  gap:8px;
}
.ai-bubble span{
Â  width:7px;height:7px;border-radius:50%;
Â  background:#FFD700;
Â  animation:typing 1.4s infinite;
}
.ai-bubble span:nth-child(2){animation-delay:.2s}
.ai-bubble span:nth-child(3){animation-delay:.4s}
@keyframes typing{0%,100%{opacity:.3}50%{opacity:1}}

.analysis-screen{
Â  position:fixed;
Â  inset:0;
Â  z-index:20;
Â  display:none;
Â  background:#000;
Â  overflow:hidden;
}

.analysis-screen.loading{
Â  display:flex;
}

.analysis-container{
Â  position:relative;
Â  width:100%;
Â  height:100%;
Â  display:flex;
Â  flex-direction:column;
Â  align-items:center;
Â  justify-content:center;
Â  overflow:hidden;
}

#analysisCanvas{
Â  position:absolute;
Â  inset:0;
Â  z-index:1;
}

.floating-particles{
Â  position:fixed;
Â  inset:0;
Â  z-index:1;
Â  pointer-events:none;
}

.particle{
Â  position:fixed;
Â  width:5px;
Â  height:5px;
Â  border-radius:50%;
Â  background:rgba(255,215,0,.8);
Â  box-shadow:0 0 10px rgba(255,215,0,.9);
Â  animation:particle-float 4s ease-in forwards;
}

@keyframes particle-float{
Â  0%{opacity:1;transform:translateY(0) translateX(0)}
Â  100%{opacity:0;transform:translateY(-150px) translateX(100px)}
}

.loading-content{
Â  position:relative;
Â  z-index:2;
Â  text-align:center;
Â  display:flex;
Â  flex-direction:column;
Â  align-items:center;
}

.animation-container{
Â  font-size:60px;
Â  margin-bottom:20px;
Â  height:80px;
Â  display:flex;
Â  align-items:center;
Â  justify-content:center;
Â  position:relative;
}

.icon-wrapper{
Â  position:relative;
Â  width:80px;
Â  height:80px;
Â  display:flex;
Â  align-items:center;
Â  justify-content:center;
}

.testube{
Â  position:absolute;
Â  animation:boil 0.8s ease-in-out infinite;
Â  opacity:1;
}

.robot-icon{
Â  position:absolute;
Â  animation:robotSpin 3s linear infinite;
Â  opacity:0;
}

@keyframes boil{
Â  0%{transform:scaleY(1) rotateZ(0deg)}
Â  25%{transform:scaleY(1.05) rotateZ(-2deg)}
Â  50%{transform:scaleY(1) rotateZ(0deg)}
Â  75%{transform:scaleY(1.05) rotateZ(2deg)}
Â  100%{transform:scaleY(1) rotateZ(0deg)}
}

@keyframes robotSpin{
Â  0%{transform:rotateY(0deg) rotateX(0deg)}
Â  100%{transform:rotateY(360deg) rotateX(10deg)}
}

.bubble{
Â  position:absolute;
Â  width:8px;
Â  height:8px;
Â  background:rgba(255,215,0,.8);
Â  border-radius:50%;
Â  box-shadow:0 0 10px rgba(255,215,0,.8);
Â  animation:bubble-rise 1.5s ease-in forwards;
}

@keyframes bubble-rise{
Â  0%{opacity:1;transform:translateY(0) translateX(0)}
Â  100%{opacity:0;transform:translateY(-60px) translateX(20px)}
}

.analysis-title{
Â  font-size:2rem;
Â  color:#FFD700;
Â  margin-bottom:10px;
Â  font-weight:700;
Â  text-shadow:0 0 20px rgba(255,215,0,.5);
}

.analysis-subtitle{
Â  font-size:0.9rem;
Â  color:#cfcfcf;
Â  margin-bottom:20px;
Â  letter-spacing:1px;
Â  text-transform:uppercase;
}

.progress-bar{
Â  width:300px;
Â  height:8px;
Â  background:rgba(255,215,0,.2);
Â  border-radius:10px;
Â  overflow:hidden;
Â  margin:0 auto 20px;
Â  border:1px solid rgba(255,215,0,.35);
}

.progress-fill{
Â  height:100%;
Â  background:linear-gradient(90deg,#FFD700,#FFA500);
Â  width:0%;
Â  animation:fillProgress 15s ease-in-out forwards;
Â  box-shadow:0 0 15px rgba(255,215,0,.8);
}

@keyframes fillProgress{
Â  0%{width:0%}
Â  100%{width:100%}
}

.status-text{
Â  color:#FFD700;
Â  font-size:0.85rem;
Â  margin-bottom:15px;
Â  min-height:20px;
Â  font-weight:600;
Â  letter-spacing:1px;
}

.results-content{
Â  position:relative;
Â  z-index:2;
Â  width:98%;
Â  max-width:1200px;
Â  height:95vh;
Â  display:none;
Â  flex-direction:column;
Â  overflow:hidden;
}

.results-header{
Â  text-align:center;
Â  margin-bottom:20px;
}

.results-header h1{
Â  font-size:2.2rem;
Â  color:#FFD700;
Â  margin-bottom:8px;
Â  text-shadow:0 0 20px rgba(255,215,0,.5);
}

.results-header p{
Â  color:#cfcfcf;
Â  font-size:0.95rem;
Â  margin-bottom:15px;
}

.table-wrapper{
Â  flex:1;
Â  overflow-y:auto;
Â  border:1px solid rgba(255,215,0,.2);
Â  border-radius:12px;
Â  background:rgba(0,0,0,.3);
Â  width:100%;
Â  box-sizing:border-box;
}

.table-wrapper::-webkit-scrollbar{
Â  width:8px;
}

.table-wrapper::-webkit-scrollbar-track{
Â  background:rgba(255,215,0,.08);
Â  border-radius:4px;
}

.table-wrapper::-webkit-scrollbar-thumb{
Â  background:linear-gradient(180deg,#FFD700,#FFA500);
Â  border-radius:4px;
Â  box-shadow:0 0 10px rgba(255,215,0,.5);
}

.table-wrapper::-webkit-scrollbar-thumb:hover{
Â  background:linear-gradient(180deg,#FFA500,#FFD700);
}

.table-wrapper{
Â  scrollbar-color:#FFD700 rgba(255,215,0,.08);
Â  scrollbar-width:thin;
}

.results-table{
Â  width:100%;
Â  border-collapse:collapse;
Â  font-size:0.9rem;
Â  text-align:left;
}

.results-table thead{
Â  position:sticky;
Â  top:0;
Â  z-index:10;
Â  background:rgba(0,0,0,.8);
Â  backdrop-filter:blur(10px);
}

.results-table th{
Â  padding:16px 12px;
Â  color:#FFD700;
Â  background:linear-gradient(90deg,rgba(255,215,0,.15),rgba(255,165,0,.1));
Â  text-transform:uppercase;
Â  font-size:0.75rem;
Â  letter-spacing:1.5px;
Â  font-weight:700;
Â  border-bottom:2px solid rgba(255,215,0,.35);
Â  white-space:nowrap;
}

.results-table td{
Â  padding:14px 12px;
Â  color:#cfcfcf;
Â  border-bottom:1px solid rgba(255,215,0,.1);
Â  word-wrap:break-word;
Â  word-break:break-word;
}

.results-table tbody tr{
Â  transition:background-color 0.2s ease;
}

.results-table tbody tr:hover{
Â  background:rgba(255,215,0,.08);
}

.results-table tbody tr:nth-child(even){
Â  background:rgba(255,215,0,.02);
}

.results-table .sno-col{
Â  width:50px;
Â  text-align:center;
Â  color:#FFD700;
Â  font-weight:700;
}

.results-table .title-col{
Â  color:#FFD700;
Â  font-weight:700;
Â  min-width:220px;
}

.results-table .invest-col{
Â  min-width:160px;
Â  color:#FFA500;
Â  font-weight:600;
Â  white-space:nowrap;
}

.results-table .detail-col{
Â  min-width:250px;
Â  color:#cfcfcf;
Â  line-height:1.4;
Â  cursor:pointer;
Â  transition:color 0.2s;
}

.results-table .detail-col:hover{
Â  color:#FFD700;
}

.results-table tbody tr:nth-child(1), .results-table tbody tr:nth-child(4), .results-table tbody tr:nth-child(7), 
.results-table tbody tr:nth-child(10), .results-table tbody tr:nth-child(13){
Â  background:rgba(255,215,0,.04);
}

.detail-modal{
Â  position:fixed;
Â  inset:0;
Â  z-index:30;
Â  display:none;
Â  background:rgba(0,0,0,.8);
Â  backdrop-filter:blur(5px);
}

.detail-modal.show{
Â  display:flex;
Â  align-items:center;
Â  justify-content:center;
}

.detail-modal-content{
Â  position:relative;
Â  width:90%;
Â  max-width:600px;
Â  background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(18,18,18,.92));
Â  border-radius:18px;
Â  border:1px solid rgba(255,215,0,.25);
Â  padding:40px;
Â  box-shadow:0 40px 120px rgba(0,0,0,.95);
Â  max-height:80vh;
Â  overflow-y:auto;
}

.detail-modal-content::-webkit-scrollbar{
Â  width:6px;
}

.detail-modal-content::-webkit-scrollbar-track{
Â  background:rgba(255,215,0,.08);
Â  border-radius:4px;
}

.detail-modal-content::-webkit-scrollbar-thumb{
Â  background:linear-gradient(180deg,#FFD700,#FFA500);
Â  border-radius:4px;
}

.modal-close{
Â  position:absolute;
Â  top:20px;
Â  right:20px;
Â  width:32px;
Â  height:32px;
Â  background:rgba(255,215,0,.2);
Â  border:none;
Â  border-radius:50%;
Â  color:#FFD700;
Â  font-size:1.5rem;
Â  cursor:pointer;
Â  display:flex;
Â  align-items:center;
Â  justify-content:center;
Â  transition:all 0.2s;
}

.modal-close:hover{
Â  background:rgba(255,215,0,.35);
}

.modal-title{
Â  font-size:1.8rem;
Â  color:#FFD700;
Â  margin-bottom:16px;
Â  margin-top:0;
Â  text-shadow:0 0 20px rgba(255,215,0,.5);
}

.modal-detail-item{
Â  margin-bottom:20px;
}

.modal-detail-label{
Â  font-size:0.75rem;
Â  color:#cfcfcf;
Â  text-transform:uppercase;
Â  letter-spacing:1.5px;
Â  font-weight:600;
Â  margin-bottom:8px;
}

.modal-detail-value{
Â  font-size:0.95rem;
Â  color:#FFD700;
Â  line-height:1.6;
Â  word-wrap:break-word;
Â  word-break:break-word;
}
</style>
</head>

<body>

<canvas id="bgCanvas"></canvas>
<div class="overlay"></div>

<div class="popup" id="budgetPopup">
Â  <div class="badge">AI SETUP</div>
Â  <h2>Define Your Budget</h2>
Â  <p>This helps us identify high-impact problems aligned with your investment capacity.</p>
Â  <div class="reaction" id="reaction">Start anywhere. Growth begins with action.</div>
Â  <input type="number" id="budgetInput" min="0" max="10000000" autofocus>
Â  <div class="warning-message" id="warningMessage"></div>
Â  <div class="actions"><button id="continueBtn" disabled>Continue</button></div>
</div>

<div class="popup" id="categoryPopup" style="top:-60%">
Â  <div class="badge">STEP 2</div>
Â  <h2>Target Problem Categories</h2>
Â  <p>Select the sectors where you wish to identify problems. (You can select multiple)</p>
Â  <div class="categories" id="categorySelection">
Â  Â  <div class="cat">Open</div><div class="cat">Agriculture</div>
Â  Â  <div class="cat">Fintech</div><div class="cat">Healthcare</div>
Â  Â  <div class="cat">Education</div><div class="cat">E-commerce</div>
Â  Â  <div class="cat">Manufacturing</div><div class="cat">Real Estate</div>
Â  Â  <div class="cat">Logistics</div><div class="cat">SaaS / AI</div>
Â  Â  <div class="cat">Technical</div><div class="cat">Others</div>
Â  </div>
Â  <div class="actions" style="margin-top:26px">
Â  Â  <button id="catContinue">Continue</button>
Â  </div>
</div>

<div class="popup" id="experiencePopup" style="top:-60%">
Â  <div class="badge">STEP 3</div>
Â  <h2>Years of Experience</h2>
Â  <p>This helps match problems to your knowledge level. Select using the slider.</p>
Â  <div class="exp-value" id="expValue">0 Years</div>
Â  <input type="range" min="0" max="50" value="0" class="exp-slider" id="expSlider">
Â  <div class="actions"><button id="expContinue">Continue</button></div>
</div>

<div class="popup" id="modePopup" style="top:-60%">
Â  <div class="badge">STEP 4</div>
Â  <h2>Mode of Operation</h2>
Â  <p>Select how your eventual solution might operate.</p>
Â  <div class="categories" id="modeSelection">
Â  Â  <div class="cat mode">Hybrid</div>
Â  Â  <div class="cat mode">Online</div>
Â  Â  <div class="cat mode">Offline</div>
Â  </div>
Â  <div class="actions" style="margin-top:26px">
Â  Â  <button id="modeContinue" disabled>Continue</button>
Â  </div>
</div>

<div class="popup" id="goalPopup" style="top:-60%">
Â  <div class="badge">STEP 5</div>
Â  <h2>Your Objectives</h2>
Â  <p>Select your primary goals when approaching a solution (You can select multiple)</p>
Â  <div class="categories" id="goalSelection">
Â  Â  <div class="cat goal">ðŸš€ Grow revenue</div>
Â  Â  <div class="cat goal">ðŸ¤– Automate operations</div>
Â  Â  <div class="cat goal">ðŸ“£ Improve marketing</div>
Â  Â  <div class="cat goal">ðŸ“Š Get insights / analytics</div>
Â  Â  <div class="cat goal">ðŸ§ª Just exploring</div>
Â  </div>
Â  <div class="actions" style="margin-top:26px">
Â  Â  <button id="goalContinue" disabled>Finish</button>
Â  </div>
</div>

<div class="analysis-screen" id="analysisScreen">
Â  <div class="analysis-container">
Â  Â  <canvas id="analysisCanvas"></canvas>
Â  Â  <div class="floating-particles" id="floatingParticles"></div>
Â  Â  
Â  Â  <div class="loading-content" id="loadingContent">
Â  Â  Â  <div class="animation-container">
Â  Â  Â  Â  <div class="icon-wrapper">
Â  Â  Â  Â  Â  <div class="testube">ðŸ§ª</div>
Â  Â  Â  Â  Â  <div class="robot-icon">ðŸ¤–</div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  Â  <div class="analysis-title">Problem Discovery Analysis</div>
Â  Â  Â  <div class="analysis-subtitle">Identifying High-Impact Problems in India</div>
Â  Â  Â  <div class="progress-bar">
Â  Â  Â  Â  <div class="progress-fill"></div>
Â  Â  Â  </div>
Â  Â  Â  <div class="status-text" id="statusText">Initializing...</div>
Â  Â  </div>

Â  Â  <div class="results-content" id="resultsContent">
Â  Â  Â  <div class="results-header">
Â  Â  Â  Â  <h1>Problem Statements Identified</h1>
Â  Â  Â  Â  <p id="resultsSubtitle">Your Top 15 Personalized Problem Statements</p>
Â  Â  Â  </div>
Â  Â  Â  
Â  Â  Â  <div class="table-wrapper">
Â  Â  Â  Â  <table class="results-table" id="resultsTable">
Â  Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  <th class="sno-col">S.No</th>
Â  Â  Â  Â  Â  Â  Â  <th>Problem Statement</th>
Â  Â  Â  Â  Â  Â  Â  <th class="invest-col">Estimated Investment (To Solve)</th>
Â  Â  Â  Â  Â  Â  Â  <th class="detail-col">View Problem Analysis</th>
Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  <tbody id="resultsBody"></tbody>
Â  Â  Â  Â  </table>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="detail-modal" id="detailModal">
Â  Â  Â  <div class="detail-modal-content">
Â  Â  Â  Â  <button class="modal-close" id="modalCloseBtn">&times;</button>
Â  Â  Â  Â  <h2 class="modal-title" id="modalTitle"></h2>
Â  Â  Â  Â  <div class="modal-detail-item">
Â  Â  Â  Â  Â  <div class="modal-detail-label">S. No</div>
Â  Â  Â  Â  Â  <div class="modal-detail-value" id="modalSNo"></div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="modal-detail-item">
Â  Â  Â  Â  Â  <div class="modal-detail-label">Estimated Investment (To Solve)</div>
Â  Â  Â  Â  Â  <div class="modal-detail-value" id="modalInvestment"></div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="modal-detail-item">
Â  Â  Â  Â  Â  <div class="modal-detail-label">Complete Detailed Problem Analysis</div>
Â  Â  Â  Â  Â  <div class="modal-detail-value" id="modalDetail"></div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>
</div>

<div class="ai-assistant" id="aiAssistant">
Â  <div class="ai-bubble"><span></span><span></span><span></span></div>
Â  <div class="ai-robot">ðŸ¤–</div>
</div>

<script>
const c=document.getElementById("bgCanvas"),ctx=c.getContext("2d");
let w,h;function rs(){w=c.width=innerWidth;h=c.height=innerHeight}
rs();addEventListener("resize",rs);
const pts=[...Array(120)].map(()=>({x:Math.random()*w,y:Math.random()*h,vx:(Math.random()-.5)*.3,vy:(Math.random()-.5)*.3}));
(function bg(){
Â  ctx.fillStyle="rgba(0,0,0,.25)";
Â  ctx.fillRect(0,0,w,h);
Â  pts.forEach(p=>{
Â  Â  p.x+=p.vx;p.y+=p.vy;
Â  Â  if(p.x<0||p.x>w)p.vx*=-1;
Â  Â  if(p.y<0||p.y>h)p.vy*=-1;
Â  Â  ctx.fillStyle="rgba(255,215,0,.8)";
Â  Â  ctx.beginPath();ctx.arc(p.x,p.y,2,0,Math.PI*2);ctx.fill();
Â  });
Â  requestAnimationFrame(bg);
})();

window.onload=()=>setTimeout(()=>budgetPopup.classList.add("show"),80);

const budgetInput = document.getElementById("budgetInput");
const warningMessage = document.getElementById("warningMessage");
const continueBtn = document.getElementById("continueBtn");

budgetInput.addEventListener("input",()=>{
Â  const value = budgetInput.value.trim();
Â  if(value === ""){
Â  Â  continueBtn.disabled = true;
Â  Â  warningMessage.classList.remove("show");
Â  } else {
Â  Â  const numValue = parseInt(value) || 0;
Â  Â  if(numValue > 10000000){
Â  Â  Â  warningMessage.textContent = "Budget cannot exceed â‚¹10,000,000";
Â  Â  Â  warningMessage.classList.add("show");
Â  Â  Â  continueBtn.disabled = true;
Â  Â  } else {
Â  Â  Â  warningMessage.classList.remove("show");
Â  Â  Â  continueBtn.disabled = false;
Â  Â  }
Â  }
});

budgetInput.addEventListener("keydown",(e)=>{
Â  if(e.key==="Enter" && !continueBtn.disabled) continueBtn.click();
});

continueBtn.onclick=()=>{
Â  const value = budgetInput.value.trim();
Â  if(value === "") return;
Â  const numValue = parseInt(value) || 0;
Â  if(numValue > 10000000) return;
Â  budgetPopup.classList.add("exit");
Â  setTimeout(()=>{
Â  Â  budgetPopup.style.display="none";
Â  Â  categoryPopup.style.top="50%";
Â  Â  categoryPopup.classList.add("show");
Â  },350);
};

const cats=document.querySelectorAll(".cat:not(.mode):not(.goal)");
cats.forEach(cat=>{
Â  cat.addEventListener("click",()=>{
Â  Â  if(cat.textContent.trim().toLowerCase()==="open"){
Â  Â  Â  const allSelected=[...cats].every(c=>c.classList.contains("selected"));
Â  Â  Â  cats.forEach(c=>allSelected?c.classList.remove("selected"):c.classList.add("selected"));
Â  Â  }else{
Â  Â  Â  cat.classList.toggle("selected");
Â  Â  }
Â  });
});

const catContinue = document.getElementById("catContinue");
catContinue.onclick=()=>{
Â  if(!document.querySelector(".cat:not(.mode):not(.goal).selected")) return;
Â  document.getElementById("categoryPopup").classList.add("exit");
Â  setTimeout(()=>{
Â  Â  document.getElementById("categoryPopup").style.display="none";
Â  Â  document.getElementById("experiencePopup").style.top="50%";
Â  Â  document.getElementById("experiencePopup").classList.add("show");
Â  },350);
};

const expSlider = document.getElementById("expSlider");
const expValue = document.getElementById("expValue");
const expContinue = document.getElementById("expContinue");

expSlider.oninput=()=>expValue.textContent=`${expSlider.value} Year${expSlider.value!=="1"?"s":""}`;
expContinue.onclick=()=>{
Â  document.getElementById("experiencePopup").classList.add("exit");
Â  setTimeout(()=>{
Â  Â  document.getElementById("experiencePopup").style.display="none";
Â  Â  document.getElementById("modePopup").style.top="50%";
Â  Â  document.getElementById("modePopup").classList.add("show");
Â  },350);
};

const modeButtons = document.querySelectorAll(".mode");
const modeContinueBtn = document.getElementById("modeContinue");

modeButtons.forEach(m=>{
Â  m.onclick=()=>{
Â  Â  modeButtons.forEach(x=>x.classList.remove("selected"));
Â  Â  m.classList.add("selected");
Â  Â  modeContinueBtn.disabled = false;
Â  };
});

modeContinueBtn.onclick=()=>{
Â  if(!document.querySelector(".mode.selected")) return;
Â  document.getElementById("modePopup").classList.add("exit");
Â  setTimeout(()=>{
Â  Â  document.getElementById("modePopup").style.display="none";
Â  Â  document.getElementById("goalPopup").style.top="50%";
Â  Â  document.getElementById("goalPopup").classList.add("show");
Â  },350);
};

document.getElementById("modePopup").addEventListener("keydown",(e)=>{
Â  if(e.key === "Enter"){
Â  Â  if(document.querySelector(".mode.selected")){
Â  Â  Â  modeContinueBtn.click();
Â  Â  }
Â  }
});

const goalButtons = document.querySelectorAll(".goal");
const goalContinueBtn = document.getElementById("goalContinue");

goalButtons.forEach(g=>{
Â  g.onclick=()=>{
Â  Â  g.classList.toggle("selected");
Â  Â  const anySelected = document.querySelector(".goal.selected");
Â  Â  goalContinueBtn.disabled = !anySelected;
Â  };
});

goalContinueBtn.onclick=()=>{
Â  if(!document.querySelector(".goal.selected")) return;
Â  startAnalysis();
};

document.getElementById("goalPopup").addEventListener("keydown",(e)=>{
Â  if(e.key === "Enter"){
Â  Â  if(document.querySelector(".goal.selected")){
Â  Â  Â  goalContinueBtn.click();
Â  Â  }
Â  }
});

document.getElementById("modalCloseBtn").addEventListener("click", closeDetailModal);
document.getElementById("detailModal").addEventListener("click", (e) => {
Â  if(e.target.id === "detailModal") closeDetailModal();
});

const API_ENDPOINT = "http://localhost:3000/generate";
const DETAIL_API_ENDPOINT = "http://localhost:3000/generate-detail"; // Added Detail Endpoint constant

let allUserData = {};

function collectUserData() {
Â  Â  const selectedCategories = Array.from(document.querySelectorAll("#categorySelection .cat.selected"))
Â  Â  Â  Â  .map(c => c.textContent.trim());

Â  Â  const selectedGoals = Array.from(document.querySelectorAll("#goalSelection .cat.selected"))
Â  Â  Â  Â  .map(g => g.textContent.trim().replace(/[\uD800-\uDBFF\uDC00-\uDFFF]/g, '').trim());

Â  Â  allUserData = {
Â  Â  Â  Â  budget: document.getElementById("budgetInput").value,
Â  Â  Â  Â  category: selectedCategories.join(", "),
Â  Â  Â  Â  experience: document.getElementById("expSlider").value,
Â  Â  Â  Â  mode: document.querySelector("#modeSelection .mode.selected").textContent.trim(),
Â  Â  Â  Â  goals: selectedGoals.join(", ")
Â  Â  };
Â  Â  return allUserData;
}

async function fetchAnalysis(data) {
Â  Â  try {
Â  Â  Â  Â  // Using the main API endpoint for initial problem generation
Â  Â  Â  Â  const response = await fetch(API_ENDPOINT, {
Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  headers: {
Â  Â  Â  Â  Â  Â  Â  Â  'Content-Type': 'application/json'
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  body: JSON.stringify(data)
Â  Â  Â  Â  });

Â  Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  Â  // Handle JSON error response if available
Â  Â  Â  Â  Â  Â  const errorData = await response.json().catch(() => ({ message: `HTTP status ${response.status}` }));
Â  Â  Â  Â  Â  Â  throw new Error(`API error: ${errorData.message || response.statusText}`);
Â  Â  Â  Â  }

Â  Â  Â  Â  const result = await response.json();
Â  Â  Â  Â  return result;

Â  Â  } catch (error) {
Â  Â  Â  Â  console.error("API Call Failed:", error);
Â  Â  Â  Â  document.getElementById("statusText").textContent = `API Error: Failed to fetch problem statements. (${error.message})`;
Â  Â  Â  Â  document.querySelector(".progress-fill").style.animationPlayState = 'paused';
Â  Â  Â  Â  return null;
Â  Â  }
}

async function startAnalysis(){
Â  const userData = collectUserData();
Â  document.getElementById("goalPopup").classList.add("exit");
Â  setTimeout(async ()=>{
Â  Â  document.getElementById("goalPopup").style.display="none";
Â  Â  const analysisScreen = document.getElementById("analysisScreen");
Â  Â  const aiAssistant = document.getElementById("aiAssistant");
Â  Â  aiAssistant.classList.add("hidden");
Â  Â  analysisScreen.classList.add("loading");
Â  Â  
Â  Â  runAnalysisAnimation();

Â  Â  // The backend generates problem statements, not ideas.
Â  Â  const results = await fetchAnalysis(userData);

Â  Â  if (results) {
Â  Â  Â  Â  displayResultsTable(results);
Â  Â  Â  Â  
Â  Â  Â  Â  document.getElementById("loadingContent").style.display = "none";
Â  Â  Â  Â  document.getElementById("resultsContent").style.display = "flex";
Â  Â  }

Â  },350);
}

function displayResultsTable(results) {
Â  Â  const resultsBody = document.getElementById("resultsBody");
Â  Â  resultsBody.innerHTML = '';
Â  Â  
Â  Â  const ideas = Array.isArray(results) ? results : [];

Â  Â  ideas.forEach(item => {
Â  Â  Â  Â  const row = document.createElement("tr");
Â  Â  Â  Â  row.innerHTML = `
Â  Â  Â  Â  Â  Â  <td class="sno-col">${item.s_no}</td>
Â  Â  Â  Â  Â  Â  <td class="title-col">${sanitizeText(item.business_title)}</td>
Â  Â  Â  Â  Â  Â  <td class="invest-col">${sanitizeText(item.estimated_investment)}</td>
Â  Â  Â  Â  Â  Â  <td class="detail-col">
Â  Â  Â  Â  Â  Â  Â  <button class="detail-btn" data-index="${item.s_no}">Click to View</button>
Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  `;
Â  Â  Â  Â  resultsBody.appendChild(row);
Â  Â  });

Â  Â  // Updated subtitle text
Â  Â  document.getElementById("resultsSubtitle").textContent = `Your Top ${ideas.length} Personalized Problem Statements`;
Â  Â  
Â  Â  attachDetailButtonListeners(ideas);
}

function attachDetailButtonListeners(ideas) {
Â  Â  document.querySelectorAll(".detail-btn").forEach(btn => {
Â  Â  Â  Â  btn.addEventListener("click", (e) => {
Â  Â  Â  Â  Â  Â  const index = parseInt(e.target.dataset.index) - 1;
Â  Â  Â  Â  Â  Â  const item = ideas[index];
Â  Â  Â  Â  Â  Â  if(item) showDetailModal(item);
Â  Â  Â  Â  });
Â  Â  });
}

async function showDetailModal(item) {
Â  Â  // Updated modal title to reflect 'Problem Statement'
Â  Â  document.getElementById("modalTitle").textContent = sanitizeText(item.business_title);
Â  Â  document.getElementById("modalSNo").textContent = item.s_no;
Â  Â  document.getElementById("modalInvestment").textContent = sanitizeText(item.estimated_investment);
Â  Â  
Â  Â  const detailValue = document.getElementById("modalDetail");
Â  Â  detailValue.textContent = "Generating detailed problem analysis..."; // Updated text
Â  Â  detailValue.style.color = "#FFA500";
Â  Â  
Â  Â  document.getElementById("detailModal").classList.add("show");
Â  Â  
Â  Â  try {
Â  Â  Â  Â  // Correctly passing the original problem title and investment to the detail endpoint
Â  Â  Â  Â  const detailedContent = await generateDetailedAnalysis(item.business_title, item.estimated_investment);
Â  Â  Â  Â  detailValue.textContent = detailedContent;
Â  Â  Â  Â  detailValue.style.color = "#FFD700";
Â  Â  } catch (error) {
Â  Â  Â  Â  detailValue.textContent = "Error generating detailed problem analysis: " + error.message; // Updated text
Â  Â  Â  Â  detailValue.style.color = "#FF6B6B";
Â  Â  }
}

async function generateDetailedAnalysis(businessTitle, investment) {
Â  Â  try {
Â  Â  Â  Â  // Using the correct detail API endpoint
Â  Â  Â  Â  const response = await fetch(DETAIL_API_ENDPOINT, {
Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  headers: {
Â  Â  Â  Â  Â  Â  Â  Â  'Content-Type': 'application/json'
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  body: JSON.stringify({
Â  Â  Â  Â  Â  Â  Â  Â  business_title: businessTitle,
Â  Â  Â  Â  Â  Â  Â  Â  investment: investment,
Â  Â  Â  Â  Â  Â  Â  Â  user_data: allUserData
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  });

Â  Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  Â  const errorData = await response.json().catch(() => ({ message: `HTTP status ${response.status}` }));
Â  Â  Â  Â  Â  Â  throw new Error(`API error: ${errorData.message || response.statusText}`);
Â  Â  Â  Â  }

Â  Â  Â  Â  const result = await response.json();
Â  Â  Â  Â  return result.detailed_analysis || "No detailed analysis available.";

Â  Â  } catch (error) {
Â  Â  Â  Â  console.error("Detail API Call Failed:", error);
Â  Â  Â  Â  throw error;
Â  Â  }
}

function closeDetailModal() {
Â  Â  document.getElementById("detailModal").classList.remove("show");
}

function sanitizeText(text) {
Â  Â  return text.replace(/[\uD800-\uDBFF\uDC00-\uDFFF]/g, '').trim();
}

function runAnalysisAnimation(){
Â  createFloatingParticles();
Â  createBoilingBubbles();
Â  animateIcons();
Â  typeStatusMessages();
}

function createFloatingParticles(){
Â  const container = document.getElementById("floatingParticles");
Â  const interval = setInterval(()=>{
Â  Â  const particle = document.createElement("div");
Â  Â  particle.className = "particle";
Â  Â  particle.style.left = Math.random()*100 + "%";
Â  Â  particle.style.top = (20 + Math.random()*60) + "%";
Â  Â  particle.style.animationDuration = (3 + Math.random()*2) + "s";
Â  Â  particle.style.animationDelay = Math.random()*1 + "s";
Â  Â  container.appendChild(particle);
Â  Â  setTimeout(()=>particle.remove(), 5000);
Â  }, 200);
}

function createBoilingBubbles(){
Â  const container = document.querySelector(".animation-container");
Â  const interval = setInterval(()=>{
Â  Â  const bubble = document.createElement("div");
Â  Â  bubble.className = "bubble";
Â  Â  bubble.style.left = (40 + Math.random()*20) + "%";
Â  Â  bubble.style.animationDuration = (1 + Math.random()*1) + "s";
Â  Â  container.appendChild(bubble);
Â  Â  setTimeout(()=>bubble.remove(), 2000);
Â  }, 200);
}

function animateIcons(){
Â  const testube = document.querySelector(".testube");
Â  const robotIcon = document.querySelector(".robot-icon");
Â  
Â  setInterval(()=>{
Â  Â  testube.style.opacity = "1";
Â  Â  robotIcon.style.opacity = "0";
Â  Â  setTimeout(()=>{
Â  Â  Â  testube.style.opacity = "0";
Â  Â  Â  robotIcon.style.opacity = "1";
Â  Â  }, 5000);
Â  Â  setTimeout(()=>{
Â  Â  Â  robotIcon.style.opacity = "0";
Â  Â  }, 10000);
Â  }, 10000);
Â  
Â  setTimeout(()=>{
Â  Â  testube.style.opacity = "0";
Â  Â  robotIcon.style.opacity = "1";
Â  }, 5000);
Â  setTimeout(()=>{
Â  Â  robotIcon.style.opacity = "0";
Â  }, 10000);
}

function typeStatusMessages(){
Â  const messages = [
Â  Â  "Analyzing user profile...",
Â  Â  "Mapping problems to budget and experience...",
Â  Â  "Generating problem statements (India-focus)...",
Â  Â  "Validating opportunity landscape...",
Â  Â  "Finalizing problem recommendations..."
Â  ];
Â  
Â  let msgIndex = 0;
Â  const statusText = document.getElementById("statusText");
Â  
Â  function showNextMessage(){
Â  Â  if(msgIndex < messages.length){
Â  Â  Â  statusText.textContent = messages[msgIndex];
Â  Â  Â  msgIndex++;
Â  Â  Â  setTimeout(showNextMessage, 3000);
Â  Â  }
Â  }
Â  showNextMessage();
}

window.addEventListener("resize",()=>{
Â  const canvas = document.getElementById("analysisCanvas");
Â  if(canvas) canvas.width = window.innerWidth;
Â  if(canvas) canvas.height = window.innerHeight;
});
</script>

</body>
</html>